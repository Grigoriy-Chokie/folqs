{{ 'section-landing-page.css' | asset_url | stylesheet_tag }}
{% style %}
  .section-{{ section.id }}--padding {
    background: {{ section.settings.background }};
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}--padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }
{% endstyle %}

{%- liquid
    assign product = section.settings.landing_product
    assign product_form_id = "form_id-" | append: product.id
    assign variant = product.selected_or_first_available_variant
    assign price = variant.price
    assign price_compare = variant.compare_at_price
  if variant.selling_plan_allocations != blank
      assign price = variant.selling_plan_allocations[0].price
      assign selling_plan = variant.selling_plan_allocations[0].selling_plan.id
      if price_compare == blank
        assign price_compare = variant.price
      endif
    endif
    assign save_money_percent = price | plus: 0.0 | divided_by: price_compare | times: 100 | minus: 100 | times: -1 | floor | append: "%"

-%}
{% if product != blank %}
<div id = "landing-product" class="landing-product section-{{ section.id }}--padding">
    <div class="landing-product__container page-width">
      {% if product.featured_image != blank %}
        <div class="landing-product__item landing-product__image">
          <div class="landing-product__image-wrapper">
          {{
          product.featured_image | image_url: width: master | image_tag: widths: '900',
          alt: product.featured_image.alt,
          loading: "lazy"
          }}
          </div>
        </div>
      {% endif %}
        <div class="landing-product__item landing-product__information">
            {% for block in section.blocks %}
                {%- case block.type -%}
                    {%- when 'title' -%}
                        <div class="landing-product__title product-block">
                            <h2 class="product-block__title">
                              {%- if block.settings.text != blank -%}
                                {{- block.settings.text -}}
                              {%- else -%}
                                {{- product.title -}}
                              {%- endif -%}
                            </h2>
                        </div>
                    {%- when 'reviews' -%}
                        <div class="product-information__reviews product-block">
                          <span class="product-information__reviews-icon">
                            {%- render "icon-stars" -%}
                          </span>
                          {% if block.settings.text != blank %}
                            <span class="product-information__reviews-text">{{- block.settings.text -}}</span>
                          {% endif %}
                        </div>
                    {%- when 'feature' -%}
                  {% if block.settings.icon and block.settings.title != blank %}
                    <div class="product-information__feature product-block">
                          <div class="product-information__feature-icon">
                            {{
                            block.settings.icon | image_url: width: master | image_tag: widths: '100',
                            alt: block.settings.icon.alt,
                            loading: "lazy"
                            }}
                          </div>
                          <div class="product-information__feature-content">
                            <h4>
                              {{ block.settings.title }}
                            </h4>
                            {% if block.settings.text != blank %}
                              <p>
                                {{ block.settings.text }}
                              </p>
                            {% endif %}
                          </div>
                      </div>
                  {% endif %}

                  {% when 'price' %}
                      <div class="product-information__price">
                        <div class="product-information__price-regular">
                          {{ price | money }}
                        </div>
                        {% if price_compare != blank %}
                          <div class="product-information__price-compare">
                            {{ price_compare | money }}
                          </div>
                          <div class="product-information__price-badge">
                            {{ 'products.product.price.save_money_percent' | t: money: save_money_percent }}
                          </div>
                        {% endif %}
                        {% if block.settings.text != blank %}
                          <div class="product-information__price-text">
                          {{ block.settings.text | replace:"[dot]", "<span></span>" }}
                          </div>
                        {% endif %}
                      </div>
                  {% when 'buy_buttons' %}
                  <div class="product-information__buy-buttons">
                  <input type="hidden" name="selling_plan" value="{{ selling_plan }}" form="{{ product_form_id }}">
                    {%- render 'buy-buttons',
                        block: block,
                        product: product,
                        product_form_id: product_form_id,
                        section_id: section.id,
                        show_bynamic_button: false
                    -%}
                      {% liquid
                        assign isShowBenefits = false
                        for benefitIndex in (1..3)
                          assign benefitId = "benefits_text" | append: benefitIndex
                          if block.settings[benefitId] != blank
                            assign isShowBenefits = true
                            break
                          endif
                        endfor
                      %}
                    {% if isShowBenefits == true and block.settings.icon != blank %}
                      <div class="buy-buttons__benefits">
                          {% for benefitIndex in (1..3) %}
                            {% assign benefitId = "benefits_text" | append: benefitIndex %}
                            {% if block.settings[benefitId] != blank %}
                              <div class="buy-buttons__benefit">
                                  {{
                                  block.settings.icon | image_url: width: master | image_tag: widths: '100',
                                  alt: block.settings.icon.alt,
                                  loading: "lazy"
                                  }}
                                <span>
                                  {{ block.settings[benefitId] }}
                                </span>
                              </div>
                            {% endif %}
                          {% endfor %}
                      </div>
                    {% endif %}
                  </div>
                {%- endcase -%}
            {% endfor %}
        </div>
    </div>
</div>
{% endif %}



{% schema %}
{
  "name": "Landing product",
  "tag": "section",
  "blocks": [
    {
      "type": "title",
      "name": "Title product",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Experience the Power of Comprehensive Nutrition"
        }
      ]
    },
    {
      "type": "reviews",
      "name": "Review product",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "3,500+ Five Star Reviews"
        }
      ]
    },
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Default title"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text,",
          "default": "Lorem ipsum dolor sit amet, consectetur adipisicing elit. A, natus, neque! Eaque ipsum iusto laborum?"
        }
      ]
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Addition text",
          "default": "$1,20 per serving [dot] 10 month supply",
          "info": "[dot] - separator"
        }
      ]
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Benefits Icon"
        },
        {
          "type": "text",
          "id": "benefits_text1",
          "label": "Benefit 1",
          "default": "Ships in 30 days"
        },
        {
          "type": "text",
          "id": "benefits_text2",
          "label": "Benefit 2",
          "default": "Free US Shipping"
        },
        {
          "type": "text",
          "id": "benefits_text3",
          "label": "Benefit 3",
          "default": "Cancel Anytime"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "color_background",
      "id": "background",
      "label": "Background",
      "default": "linear-gradient(#E4F0FF 29.75%, rgba(228, 240, 255, 0.00) 100%)"
    },
    {
      "type": "paragraph",
      "content": "Space between sections on the desktop"
    },
    {
      "type": "range",
      "id": "padding_top",
      "label": "Padding top",
      "unit": "px",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "label": "Padding bottom",
      "unit": "px",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 0
    },
    {
      "type": "paragraph",
      "content": "Space between sections on the mobile"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Padding top",
      "unit": "px",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 0
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Padding bottom",
      "unit": "px",
      "min": 0,
      "max": 100,
      "step": 1,
      "default": 0
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Only Natural Ungredients"
    },
    {
      "type": "text",
      "id": "sub_heading",
      "label": "Sub-heading",
      "default": "Lorem ipsum dolor sit amet consectetur. Gravida facilisi eleifend sit quam morbi risus id. Nisl massa donec tincidunt."
    },
    {
      "type": "product",
      "id": "landing_product",
      "label": "Landing product"
    }
  ],
  "presets": [
    {
      "name": "Landing product",
      "blocks": [
        {
          "type": "title"
        },
        {
          "type": "reviews"
        },
        {
          "type": "feature"
        },
        {
          "type": "feature"
        },
        {
          "type": "feature"
        },
        {
          "type": "price"
        },
        {
          "type": "buy_buttons"
        }
      ]
    }
  ]
}
{% endschema %}