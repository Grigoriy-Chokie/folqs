{{ 'section-info-slider.css' | asset_url | stylesheet_tag }}

{% liquid
  assign padding_top = section.settings.padding_top
  assign padding_bottom = section.settings.padding_bottom
  assign padding_top_mobile = section.settings.padding_top_mobile
  assign padding_bottom_mobile = section.settings.padding_bottom_mobile
%}

{% if section.settings.bg_image_desk != blank %}
  <style>
    .section-{{ section.id }}--padding {
      background: url("{{ section.settings.bg_image_desk | img_url: 'master' }}") center center/cover no-repeat;
    }
  </style>
{% endif %}

{% if section.settings.bg_image_mob != blank %}
  <style>
    @media screen and (max-width: 990px) {
      .section-{{ section.id }}--padding {
        background: url("{{ section.settings.bg_image_mob | img_url: 'master' }}") center center/cover no-repeat;
      }
    }
  </style>
{% endif %}

<section class="info__slider section-{{ section.id }}--padding">
  <div class="c-container">
    {% if section.settings.heading != blank %}
      <h2 class="info__slide-main-heading">{{ section.settings.heading }}</h2>
    {% endif %}
    <div class="info__slide-wrapper">
      {% for block in section.blocks %}
        {% render 'info-slide', block: block %}
      {% endfor %}
    </div>
    <div class="swiper info-slider-swiper">
      <div class="swiper-wrapper">
        {% assign blocks_per_slide = 4 %}
        {% assign total_blocks = section.blocks.size %}
        {% assign slide_index = 0 %}

        {% for block in section.blocks %}
          {% assign block_index = forloop.index0 %}
          {% assign is_new_slide = block_index | modulo: blocks_per_slide %}

          {% if block_index == 0 or is_new_slide == 0 %}
            {% if block_index > 0 %}
              </div> 
            {% endif %}
            <div class="swiper-slide" data-slide="{{ slide_index }}">
            {% assign slide_index = slide_index | plus: 1 %}
          {% endif %}

          {% render 'info-slide', block: block %}

          {% if forloop.last %}
            </div> 
          {% endif %}
        {% endfor %}
      </div>
      <div class="swiper-pagination"></div>
    </div>
  </div>
</section>

{% render 'section-paddings-v3',
  padding_top: padding_top,
  padding_bottom: padding_bottom,
  padding_top_mobile: padding_top_mobile,
  padding_bottom_mobile: padding_bottom_mobile
%}

{% schema %}
  {
    "name": "Info slider",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading"
      },
      {
        "type": "image_picker",
        "id": "bg_image_desk",
        "label": "Background image desktop"
      },
      {
        "type": "image_picker",
        "id": "bg_image_mob",
        "label": "Background image mobile"
      },
      {
        "type": "header",
        "content": "Paddings"
      },
      {
        "type": "range",
        "id": "padding_top",
        "label": "Padding top",
        "min": 0,
        "max": 200,
        "step": 2,
        "unit": "px",
        "default": 120
      },
      {
        "type": "range",
        "id": "padding_bottom",
        "label": "Padding bottom",
        "min": 0,
        "max": 200,
        "step": 2,
        "unit": "px",
        "default": 90
      },
      {
        "type": "range",
        "id": "padding_top_mobile",
        "label": "Padding top mobile",
        "min": 0,
        "max": 200,
        "step": 2,
        "unit": "px",
        "default": 66
      },
      {
        "type": "range",
        "id": "padding_bottom_mobile",
        "label": "Padding bottom mobile",
        "min": 0,
        "max": 200,
        "step": 2,
        "unit": "px",
        "default": 40
      }
    ],
    "blocks": [
      {
        "type": "slide",
        "name": "Slide",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Title"
          },          
          {
            "type": "image_picker",
            "id": "small_image",
            "label": "Small image"
          },
          {
            "type": "image_picker",
            "id": "main_image",
            "label": "Main image"
          },
          {
            "type": "richtext",
            "id": "content",
            "label": "Content",
            "default": "<p></p>"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Info slider"
      }
    ]
  }
{% endschema %}
