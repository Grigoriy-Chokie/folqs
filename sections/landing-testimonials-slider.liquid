{{ 'section-landing-testimonials-slider.css' | asset_url | stylesheet_tag }}

{% liquid
  assign padding_desktop_top = section.settings.padding_top
  assign padding_desktop_bottom = section.settings.padding_bottom
  assign padding_top_mobile = section.settings.padding_top_mobile
  assign padding_bottom_mobile = section.settings.padding_bottom_mobile
  assign title = section.settings.title
  assign subtitle = section.settings.subtitle
%}
{%- style -%}
  #shopify-section-{{ section.id }} {
    padding-top: {{ padding_desktop_top }}px;
    padding-bottom: {{ padding_desktop_bottom }}px;
  }

  @media(max-width: 768px) {
    #shopify-section-{{ section.id }} {
      padding-top: {{ padding_top_mobile }}px;
      padding-bottom: {{ padding_bottom_mobile }}px;
    }
  }
{%- endstyle -%}

<div class="landing-testimonials__wrapper {% if template.name == 'index' -%}landing-testimonials--new-home-page{%- endif %}">
  <div class="landing-testimonials__text-container">
    {% if subtitle != blank %}
      <p class="landing-testimonials__subtitle">{{ subtitle }}</p>
    {% endif %}
    {% if title != blank %}
      <div class="landing-testimonials__title">{{ title }}</div>
    {% endif %}
  </div>  

  <div class="swiper landing-testimonials-swiper">
    <div class="swiper-wrapper">
      {% for block in section.blocks %}
        {% liquid
          assign ratio_percent = '138'
          assign heading = block.settings.heading
          assign content = block.settings.content
          assign author = block.settings.author
        %}

        <div class="swiper-slide testimonial-slide">
          <div class="testimonial">
            <div class="testimonial__image-group">
              {% for i in (1..2) %}
                {% liquid
                  assign image_id = 'image_' | append: i
                  assign image = block.settings[image_id]
                %}

                {% if image != blank %}
                  <div class="image-group__item">
                    <div class="image-group__picture" style="--ratio-percent: {{ ratio_percent | append: '%' }}">
                      {% render 'picture',
                        image: image,
                        widths_list: '350, 500, 800, 1200, 1500',
                        loading: 'lazy',
                        fetchpriority: 'low',
                        image_alt: image.alt
                      %}
                    </div>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
            <div class="testimonial__info">
              {% if author != blank %}
                <div class="testimonial__author-content">
                  <h4 class="testimonial__author">{{ author }}</h4>
                  <div class="testimonial__verified-badge">
                    {{ 'icon-lp-verified-buyer.svg' | inline_asset_content }}
                    <p class="testimonial__verified-text">Verified buyer</p>
                  </div>
                </div>
              {% endif %}
              <div class="testimonial__stars">
                {%- if template.name == 'index' -%}
                  {{ 'icon-stars-new.svg' | inline_asset_content }}
                {%- else -%}
                  {{ 'icon-lp-testimonials-stars.svg' | inline_asset_content }}
                {%- endif -%}
              </div>
              {% if heading != blank %}
                <h3 class="testimonial__heading">{{ heading }}</h3>
              {% endif %}
              {% if content != blank %}
                <p class="testimonial__content">{{ content }}</p>
              {% endif %}
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>

</div>

<script src="{{ 'section-landing-testimonials.js' | asset_url }}" defer="defer"></script>

{% schema %}
{
  "name": "Testimonials Slider",
  "settings": [
    {
      "type": "checkbox",
      "id": "extra_styles",
      "label": "Extra styles",
      "default": false
    },
    {
      "type": "header",
      "content": "Section's space between"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px",
      "label": "Padding Top"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px",
      "label": "Padding Bottom"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px",
      "label": "Padding Top Mobile"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "min": 0,
      "max": 200,
      "step": 2,
      "default": 0,
      "unit": "px",
      "label": "Padding Bottom Mobile"
    },
    {
      "type": "richtext",
      "id": "title",
      "label": "Title"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
         {
          "type": "image_picker",
          "id": "image_1",
          "label": "First Image"
        },
         {
          "type": "image_picker",
          "id": "image_2",
          "label": "Second Image"
        },
        {
          "type": "text",
          "id": "author",
          "label": "Author"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "content",
          "label": "Content"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Landing Testimonials Slider"
    }
  ]
}
{% endschema %}
